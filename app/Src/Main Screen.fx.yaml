"'Main Screen' As screen":

    CurrentScoreLabel As label:
        FontWeight: =FontWeight.Bold
        Height: =68
        Size: =26
        Text: |-
            ="Current Score: " & CurrentScore
        Width: =360
        X: =40
        Y: =40
        ZIndex: =1

    TotalScoreLabel As label:
        FontWeight: =FontWeight.Bold
        Height: =68
        Size: =26
        Text: |-
            ="Total Score: " & TotalScore
        Width: =360
        X: =482
        Y: =40
        ZIndex: =2

    Flag As image:
        Height: =250
        Image: =PlayingNow.cr3ba_url
        Width: =250
        X: =524
        Y: =158
        ZIndex: =3

    MainSubmitBtn As button:
        OnSelect: |
            =If(
                Lower(TextInput.Text) = Lower(PlayingNow.cr3ba_country_name), 
                UpdateContext({GameCondition: "correct"}), 
                UpdateContext({GameCondition: "wrong"})
            );
            If(GameCondition = "correct", 
                Set(TotalScore, TotalScore+CurrentScore);
                Set(CurrentScore, 100);
                Reset(TextInput);
                UpdateContext({
                    LastCountry: PlayingNow,
                    ShowLang: false, 
                    ShowCurr: false, 
                    ShowArea: false, 
                    RevealCount: 0, 
                    ShowPopup: true, 
                    PplRandNum: RandBetween(-3, 0)
                });
                RemoveIf(Unplayed, cr3ba_country_name = PlayingNow.cr3ba_country_name);
                Set(PlayingNow, First(Shuffle(Unplayed))), 
                Set(CurrentScore, CurrentScore - 10)
            )
        Text: ="Go!"
        Width: =110
        X: =753
        Y: =408
        ZIndex: =4

    TextInput As text:
        Default: =
        HintText: ="Enter Country Name"
        OnChange: =
        X: =365
        Y: =408
        ZIndex: =5

    Banner As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =76
        Size: =20
        Text: =Switch(GameCondition, "gaveup",Concatenate("It was ", LastCountry.cr3ba_country_name, ". Better luck next time!"), "wrong", "Nope!")
        Visible: =!(Len(TextInput.Text) = 0) || GameCondition = "gaveup"
        Width: =766
        X: =273
        Y: =120
        ZIndex: =6

    LanguageBtn As button:
        Height: =44
        OnSelect: |-
            =UpdateContext({ShowLang: true});
            Set(CurrentScore, CurrentScore-5)
        Text: ="See the language"
        Tooltip: ="This will cost you 5 points"
        Width: =277
        X: =651
        Y: =486
        ZIndex: =7

    LanguageLabel As label:
        Size: =20
        Text: =PlayingNow.cr3ba_lang_name
        Visible: =ShowLang
        Width: =362
        X: =956
        Y: =490
        ZIndex: =8

    AreaBtn As button:
        Height: =44
        OnSelect: |-
            =UpdateContext({ShowArea: true});
            Set(CurrentScore, CurrentScore-5)
        Text: ="See the area"
        Tooltip: ="This will cost you 5 points"
        Width: =277
        X: =651
        Y: =620
        ZIndex: =9

    AreaLabel As label:
        Size: =20
        Text: |-
            =Text(PlayingNow.cr3ba_total_area, "##,###")&" km2"
        Visible: =ShowArea
        Width: =362
        X: =956
        Y: =624
        ZIndex: =10

    CurrencyBtn As button:
        Height: =44
        OnSelect: |-
            =UpdateContext({ShowCurr: true});
            Set(CurrentScore, CurrentScore-5)
        Text: ="See the currency"
        Tooltip: ="This will cost you 5 points"
        Width: =277
        X: =651
        Y: =552
        ZIndex: =11

    CurrencyLabel As label:
        Size: =20
        Text: =PlayingNow.cr3ba_currency_name
        Visible: =ShowCurr
        Width: =362
        X: =958
        Y: =557
        ZIndex: =12

    "'Reveal Letter Button' As button":
        DisplayMode: =If(RevealCount < Len(PlayingNow.cr3ba_country_name), DisplayMode.Edit, DisplayMode.Disabled)
        Height: =107
        OnSelect: |-
            =UpdateContext({RevealCount: RevealCount + 1});
            Set(CurrentScore, CurrentScore-15)
        Text: ="Reveal the next letter"
        Tooltip: ="This will cost you 15 points"
        Width: =274
        X: =186
        Y: =523
        ZIndex: =13

    "'Revealed Letters' As label":
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Height: =66
        Size: =20
        Text: =Left(PlayingNow.cr3ba_country_name, RevealCount)
        Width: =256
        X: =195
        Y: =666
        ZIndex: =14

    GiveupBtn As button:
        OnSelect: |-
            =UpdateContext({
                GameCondition: "gaveup", 
                LastCountry:PlayingNow, 
                ShowLang: false, 
                ShowCurr: false, 
                ShowArea: false, 
                RevealCount: 0
            });
            Reset(TextInput);
            Set(CurrentScore, 100);
            Set(PlayingNow, First(Shuffle(Unplayed)))
        Text: ="Give up"
        X: =928
        Y: =408
        ZIndex: =15

    ResetGameBtn As button:
        Height: =66
        OnSelect: =Navigate('Initial Screen', ScreenTransition.Fade)
        Text: ="Reset Game"
        Width: =234
        X: =1084
        Y: =40
        ZIndex: =16

    Popup As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =29

        "'Popup Background' As rectangle":
            Fill: =RGBA(102, 102, 102, 0.83)
            Height: =App.Height
            OnSelect: =
            Visible: =ShowPopup
            Width: =App.Width
            ZIndex: =17

        "'Popup Screen' As rectangle":
            Fill: =RGBA(241, 244, 249, 1)
            Height: =554
            OnSelect: =
            Visible: =ShowPopup
            Width: =1102
            X: =141
            Y: =94
            ZIndex: =18

        "'Congrats Label' As label":
            Align: =Align.Center
            Height: =160
            OnSelect: =
            Size: =24
            Text: |-
                ="You guessed it! Well done!
                
                Do you want to earn some points by guessing the capital or population?"
            Visible: =ShowPopup
            Width: =840
            X: =273
            Y: =156
            ZIndex: =19

        GoBackBtn As button:
            OnSelect: |-
                =UpdateContext({
                    ShowPopup: false,
                    PplGuessSubmitted: false,
                    PplBonus: 0,
                    CapitalGuessSubmitted: false,
                    CapitalBonus: 0
                })
                 
            Text: ="Go Back"
            Visible: =ShowPopup
            X: =603
            Y: =542
            ZIndex: =20

        "'Guess Population Label' As label":
            OnSelect: =
            Size: =16
            Text: ="Population"
            Visible: =ShowPopup
            Width: =134
            X: =184
            Y: =369
            ZIndex: =21

        "'Guess Area Label' As label":
            Height: =42
            Size: =16
            Text: ="Capital City"
            Visible: =ShowPopup
            Width: =134
            X: =184
            Y: =438
            ZIndex: =22

        PplSlider As slider:
            Default: =If(PplGuessSubmitted, LastCountry.cr3ba_population, (MinPpl + MaxPpl) / 2)
            Height: =38
            Max: =MaxPpl
            Min: =MinPpl
            Tooltip: =
            Visible: =ShowPopup
            Width: =673
            X: =318
            Y: =371
            ZIndex: =23

        SubmitPpl As button:
            DisplayMode: =If(PplGuessSubmitted, DisplayMode.View , DisplayMode.Edit)
            Fill: =If(PplGuessSubmitted, Color.ForestGreen , RGBA(56, 96, 178, 1))
            OnSelect: |
                =UpdateContext({
                    PplGuessSubmitted: true,
                    PplBonus: Int(
                        (1 - (Abs(PplSlider.Value - LastCountry.cr3ba_population) / Max(
                            MaxPpl - LastCountry.cr3ba_population,
                            LastCountry.cr3ba_population - MinPpl
                        ))) * 20
                    )
                });
                Set(CurrentScore, CurrentScore + PplBonus);
                Reset(PplSlider);
            Text: |-
                =If(PplGuessSubmitted, "Score: " & PplBonus , "Submit Answer")
            Visible: =ShowPopup
            Width: =194
            X: =1005
            Y: =369
            ZIndex: =24

        CapitalRadio As radio:
            Default: =If(CapitalGuessSubmitted, LastCountry.cr3ba_capital, "")
            DisplayMode: =If(CapitalGuessSubmitted, DisplayMode.Disabled, DisplayMode.Edit)
            Height: =79
            Items: |-
                =ShowColumns(
                    Shuffle(
                        Ungroup(
                            Table(
                                {MyTables: FirstN(Shuffle(Filter(CountriesCollection,cr3ba_capital<>LastCountry.cr3ba_capital)), 3)}, 
                                {MyTables: Table(LastCountry)}), 
                            "MyTables"
                        )
                    ), 
                    "cr3ba_capital"
                )
            Layout: =Layout.Horizontal
            Reset: =true
            Visible: =ShowPopup
            Width: =673
            X: =318
            Y: =425
            ZIndex: =25

        SubmitCapital As button:
            DisplayMode: =If(CapitalGuessSubmitted, DisplayMode.View , DisplayMode.Edit)
            Fill: =If(CapitalGuessSubmitted, Color.ForestGreen , RGBA(56, 96, 178, 1))
            OnSelect: |-
                =UpdateContext({CapitalGuessSubmitted: true, CapitalBonus: If(CapitalRadio.Selected.cr3ba_capital = LastCountry.cr3ba_capital, 10, 0)});
                Set(CurrentScore, CurrentScore + CapitalBonus);
                Reset(CapitalRadio);
            Text: |-
                =If(CapitalGuessSubmitted, "Score: " & CapitalBonus , "Submit Answer")
            Visible: =ShowPopup
            Width: =194
            X: =1005
            Y: =449
            ZIndex: =26

